%!PS-Adobe-2.0
%%Creator: dvipsk 5.58f Copyright 1986, 1994 Radical Eye Software
%%Title: gmake.dvi
%%Pages: 10
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Bold Courier Times-Italic
%%EndComments
%DVIPSCommandLine: /usr/sww/bin/dvips -f gmake.dvi
%DVIPSParameters: dpi=300, comments removed
%DVIPSSource:  TeX output 1998.01.29:1101
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore showpage
userdict /eop-hook known{eop-hook}if}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
TeXDict begin 40258437 52099154 1000 300 300 (gmake.dvi)
@start /Fa 1 71 df<01FFFFFF001E001E001E0006001E0006001E0002003C0002003C
0002003C0002003C00020078000400780200007802000078020000F0040000F00C0000FF
FC0000F00C0001E0080001E0080001E0080001E0080003C0000003C0000003C0000003C0
0000078000000780000007800000078000000F800000FFFC0000201F7E9E1D>70
D E /Fb 4 121 df<70F8F8F87005057C8D0D>1 D<000F0038006000E001C001C001C001
C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F8001E00070003
8001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C000E0006000
38000F102D7DA117>102 D<F8001E000700038001C001C001C001C001C001C001C001C0
01C001C001C001C001C001C001C000E000600038000F0038006000E001C001C001C001C0
01C001C001C001C001C001C001C001C001C001C001C0038007001E00F800102D7DA117>
I<0F80184030207010E030E070E020E000E00060007000300018000600198030C0706060
70E030E038E038E03860387030307018600CC0030000C000600070003000380038203870
3860384070206010C00F800D297D9F14>120 D E /Fc 81[25 54[33
2[13 18 15 1[23 23 23 36 13 2[13 23 23 1[20 1[20 1[20
16[25 1[33 5[33 4[30 30 19[11 46[{.167 SlantFont}22 45.833332
/Times-Roman rf /Fd 138[19 1[15 15 19 7[10 3[17 101[{}6
37.500000 /Times-Italic rf /Fe 59[22 70[22 1[22 1[22
22 22 22 22 22 22 22 22 22 22 22 22 22 22 1[22 22 22
22 22 22 22 22 22 1[22 2[22 3[22 22 2[22 22 22 1[22 22
1[22 22 1[22 22 1[22 22 22 22 22 22 22 2[22 22 1[22 22
10[22 22 22 22 22 22 22 22 3[22 22 22 34[{}62 37.500000
/Courier rf /Ff 69[17 15[17 48[19 19 27 1[19 10 15 12
1[19 19 19 29 10 19 1[10 19 19 12 17 19 17 19 17 11[27
1[21 25 1[21 1[27 33 3[12 1[27 21 1[27 2[27 6[10 19 19
6[19 2[9 1[9 2[12 12 12 39[{}44 37.500000 /Times-Roman
rf /Fg 205[12 12 49[{}2 25.000000 /Times-Roman rf /Fh
81[28 52[25 25 36 25 28 17 19 22 1[28 25 28 41 14 28
1[14 28 25 17 22 28 22 28 25 10[36 2[28 3[39 1[47 2[25
19 4[36 36 33 10[25 25 25 25 25 25 25 49[{}40 50.000000
/Times-Bold rf /Fi 205[17 17 49[{}2 33.333332 /Times-Roman
rf /Fj 81[23 56[23 13 18 18 1[23 23 23 33 13 20 1[13
1[23 1[20 23 20 1[23 51[15 45[{}18 45.833332 /Times-Italic
rf /Fk 60[27 69[27 1[27 1[27 27 27 27 27 27 27 27 1[27
27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 1[27 2[27
3[27 27 27 27 27 27 27 1[27 27 1[27 27 1[27 27 27 27
27 27 27 27 27 27 27 2[27 27 1[27 6[27 27 27 1[27 27
27 27 27 27 27 27 1[27 27 27 27 27 27 33[{}71 45.833332
/Courier rf /Fl 81[25 54[33 2[15 18 20 1[25 23 25 38
13 2[13 25 23 1[20 1[20 1[23 13[25 2[28 1[33 5[36 4[33
30 8[23 23 1[23 4[23 2[11 46[{}27 45.833332 /Times-Bold
rf /Fm 47[46 21[20 11[25 3[20 47[20 23 23 33 23 23 13
18 15 23 23 23 23 36 13 23 13 13 23 23 15 20 23 20 23
20 15 6[33 33 43 33 33 28 25 30 1[25 33 33 41 28 1[18
15 33 33 25 28 33 30 30 33 42 4[13 13 23 23 23 23 23
23 23 23 23 23 1[11 15 11 26 1[15 15 15 2[23 23 35[{}76
45.833332 /Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 39 1
39 0 bop 678 303 a Fm(UNIVERSITY)12 b(OF)g(CALIFORNIA)650
360 y(Department)f(of)h(Electrical)f(Engineering)778
416 y(and)g(Computer)g(Sciences)742 473 y(Computer)g(Science)h(Di)o
(vision)75 670 y Fl(CS61B)1427 b(P)-5 b(.)11 b(N.)h(Hil\256nger)75
726 y(Spring)g(1998)610 900 y(Basic)f(Compilation)g(Contr)o(ol)h(with)f
Fk(Gmake)145 1004 y Fm(Ev)o(en)h(relati)o(v)o(ely)g(small)e(software)i
(systems)e(can)i(require)g(rather)g(in)n(v)o(olv)o(ed,)g(or)g(at)g
(least)f(tedious,)g(sequences)75 1061 y(of)e(instructions)f(to)h
(translate)g(them)g(from)g(source)h(to)f(e)o(x)o(ecutable)h(forms.)16
b(Furthermore,)10 b(since)g(translation)e(takes)75 1117
y(time)i(\(more)i(than)f(it)g(should\))f(and)h(systems)f(generally)i
(come)f(in)g(separately-translatable)g(parts,)h(it)f(is)f(desirable)75
1174 y(to)k(sa)o(v)o(e)h(time)e(by)i(updating)e(only)g(those)h
(portions)f(whose)i(source)f(has)h(changed)f(since)g(the)h(last)f
(compilation.)75 1230 y(Ho)o(we)o(v)o(er)n(,)e(keeping)e(track)h(of)g
(and)h(using)e(such)g(information)g(is)h(itself)f(a)h(tedious)f(and)h
(error)o(-prone)h(task,)f(if)g(done)75 1287 y(by)g(hand.)145
1343 y(The)19 b(UNIX)f Fk(make)i Fm(utility)c(is)i(a)g
(conceptually-simple)f(and)h(general)h(solution)d(to)i(these)g
(problems.)36 b(It)75 1399 y(accepts)17 b(as)f(input)f(a)i(description)
e(of)i(the)f(interdependencies)g(of)g(a)h(set)f(of)h(source)f(\256les)h
(and)f(the)g(commands)75 1456 y(necessary)d(to)f(compile)f(them,)i(kno)
o(wn)e(as)i(a)f Fj(make\256le)p Fm(;)h(it)f(e)o(xamines)g(the)g(ages)h
(of)f(the)g(appropriate)h(\256les;)f(and)h(it)75 1512
y(e)o(x)o(ecutes)f(whate)o(v)o(er)g(commands)e(are)i(necessary)m(,)g
(according)g(to)f(the)g(description.)16 b(F)o(or)c(further)f(con)n(v)o
(enience,)i(it)75 1569 y(will)c(supply)g(certain)i(standard)f(actions)g
(and)g(dependencies)g(by)g(default,)g(making)g(it)g(unnecessary)g(to)g
(state)g(them)75 1625 y(e)o(xplicitly)m(.)145 1682 y(There)k(are)g
(numerous)f(dialects)g(of)g Fk(make)p Fm(,)j(both)d(among)f(UNIX)i
(installations)d(and)i(\(under)h(other)f(names\))75 1738
y(in)d(programming)f(en)n(vironments)g(for)h(personal)h(computers.)k
(In)c(this)e(course,)i(we)g(will)f(use)g(a)g(v)o(ersion)h(kno)o(wn)e
(as)75 1795 y Fk(gmake)210 1778 y Fi(1)230 1795 y Fm(.)20
b(Though)12 b(conceptually)f(simple,)h(the)g Fk(make)i
Fm(utility)d(has)h(accreted)i(features)f(with)e(age)i(and)f(use,)h(and)
75 1851 y(is)f(rather)h(imposing)e(in)h(the)g(glory)g(of)h(its)f(full)g
(de\256nition.)20 b(This)12 b(document)f(describes)i(only)f(the)g
(simple)g(use)g(of)75 1908 y Fk(gmake)p Fm(.)75 2032
y Fh(1)49 b(Basic)13 b(Operation)e(and)h(Syntax)75 2119
y Fm(The)h(follo)o(wing)e(is)i(a)g(sample)g(make\256le)725
2103 y Fi(2)757 2119 y Fm(for)g(compiling)e(a)j(simple)e(editor)g
(program,)i Fk(edit)p Fm(,)i(from)d(eight)f Fk(.cc)75
2176 y Fm(\256les)f(and)h(three)f(header)h(\()p Fk(.h)p
Fm(\))h(\256les.)184 2268 y Fk(#)28 b(Makefile)j(for)d(simple)i(editor)
184 2381 y(edit)f(:)f(edit.o)i(kbd.o)f(commands.)q(o)i(display.o)g(\\)p
75 2418 735 2 v 127 2446 a Fg(1)142 2462 y Ff(F)o(or)8
b(\252GNU)f Fe(make)p Ff(,)m(\272)j(GNU)e(being)e(an)h(acron)o(ym)g
(for)h(\252GNU')n(s)f(Not)h(Unix.)m(\272)13 b Fe(gmake)c
Ff(is)f(\252copylefted\272)d(\(it)k(has)d(a)h(license)g(that)g
Fd(r)o(equir)o(es)75 2507 y Ff(free)i(use)f(of)i(an)o(y)e(product)h
(containing)f(it\).)15 b(It)10 b(is)f(also)g(more)g(po)o(werful)g(than)
g(the)g(standard)f Fe(make)j Ff(utility)n(.)127 2538
y Fg(2)142 2554 y Ff(Adapted)6 b(from)j(\252GNU)e(Make:)12
b(A)c(Program)f(for)i(Directing)f(Recompilation\272)e(by)h(Richard)h
(Stallman)f(and)g(Roland)g(McGrath,)h(1988.)971 2678
y Fm(39)p eop
%%Page: 40 2
40 1 bop 50 50 a Fm(40)1527 b Fc(P)-5 b(.)13 b(N.)e(Hil\256nger)351
199 y Fk(insert.o)31 b(search.o)f(files.o)h(utils.o)379
256 y(g++)d(-g)g(-o)h(edit)g(edit.o)g(kbd.o)h(commands.o)h(display.o)g
(\\)680 312 y(insert.o)g(search.o)f(files.o)g(utils.o)g(-lg++)159
425 y(edit.o)g(:)e(edit.cc)i(defs.h)379 482 y(g++)e(-g)g(-c)h(-Wall)g
(edit.cc)159 538 y(kbd.o)h(:)e(kbd.cc)h(defs.h)h(command.h)379
594 y(g++)e(-g)g(-c)h(-Wall)g(kbd.cc)159 651 y(commands)q(.o)i(:)d
(command.cc)j(defs.h)f(command.h)379 707 y(g++)e(-g)g(-c)h(-Wall)g
(commands.)q(cc)159 764 y(display.)q(o)h(:)e(display.c)q(c)j(defs.h)e
(buffer.h)379 820 y(g++)f(-g)g(-c)h(-Wall)g(display.c)q(c)159
877 y(insert.o)i(:)d(insert.cc)j(defs.h)f(buffer.h)379
933 y(g++)e(-g)g(-c)h(-Wall)g(insert.cc)159 990 y(search.o)i(:)d
(search.cc)j(defs.h)f(buffer.h)379 1046 y(g++)e(-g)g(-c)h(-Wall)g
(search.cc)159 1103 y(files.o)i(:)c(files.cc)k(defs.h)f(buffer.h)g
(command.h)379 1159 y(g++)e(-g)g(-c)h(-Wall)g(files.cc)159
1215 y(utils.o)i(:)c(utils.cc)k(defs.h)379 1272 y(g++)d(-g)g(-c)h
(-Wall)g(utils.cc)50 1367 y Fm(This)8 b(\256le)i(consists)e(of)i(a)f
(sequence)h(of)g(nine)f Fj(rules)p Fm(.)15 b(Each)10
b(rule)f(consists)f(of)i(a)g(line)e(containing)h(two)f(lists)g(of)i
(names)50 1423 y(separated)i(by)g(a)g(colon,)g(follo)o(wed)g(by)f(one)h
(or)h(more)f(lines)f(be)o(ginning)g(with)g(tab)h(characters.)20
b(An)o(y)12 b(line)g(may)f(be)50 1480 y(continued,)j(as)f(illustrated,)
h(by)f(ending)g(it)g(with)g(a)h(backslash-ne)o(wline)f(combination,)g
(which)g(essentially)f(acts)50 1536 y(like)e(a)h(space,)h(combining)d
(the)i(line)f(with)h(its)f(successor)m(.)17 b(The)11
b(`#')g(character)h(indicates)f(the)g(start)f(of)h(a)g(comment)50
1593 y(that)g(goes)g(to)g(the)g(end)g(of)h(the)f(line.)120
1650 y(The)17 b(names)f(preceding)h(the)f(colons)g(are)h(kno)o(wn)f(as)
g Fj(tar)n(gets)p Fm(;)i(the)o(y)e(are)h(most)f(often)g(the)g(names)h
(of)f(\256les)50 1706 y(that)d(are)h(to)f(be)h(produced.)23
b(The)13 b(names)g(follo)o(wing)f(the)i(colons)e(are)j(kno)o(wn)d(as)i
Fj(dependencies)f Fm(of)h(the)f(tar)o(gets.)50 1763 y(The)o(y)h
(usually)f(denote)g(other)h(\256les)g(\(generally)m(,)h(other)f(tar)o
(gets\))g(that)f(must)g(be)h(present)f(and)h(up-to-date)g(before)50
1819 y(the)d(tar)o(get)g(can)h(be)f(processed.)17 b(The)11
b(lines)g(starting)f(with)h(tabs)f(that)h(follo)o(w)f(the)h(\256rst)h
(line)f(of)g(a)g(rule)h(we)f(will)f(call)50 1875 y Fj(actions)p
Fm(.)25 b(The)o(y)14 b(are)h(shell)f(commands)f(\(that)i(is,)g
(commands)e(that)h(you)g(could)g(type)g(in)g(response)g(to)g(the)g
(Unix)50 1932 y(prompt\))c(that)g(get)g(e)o(x)o(ecuted)i(in)e(order)h
(to)f(create)i(or)e(update)h(the)f(tar)o(get)h(of)f(the)h(rule)f
(\(we'll)h(use)f(the)h(generic)g(term)50 1988 y Fj(update)g
Fm(for)g(both\).)120 2045 y(Each)g(rule)g(says,)g(in)f(ef)o(fect,)i
(that)e(to)g(update)g(the)g(tar)o(gets,)h(each)h(of)e(the)h
(dependencies)f(must)f(\256rst)i(be)g(updated)50 2102
y(\(recursi)o(v)o(ely\).)20 b(Ne)o(xt,)13 b(if)f(a)h(tar)o(get)f(does)g
(not)g(e)o(xist)g(\(that)g(is,)g(if)h(no)f(\256le)g(by)g(that)g(name)g
(e)o(xists\))g(or)h(if)f(it)g(does)g(e)o(xist)50 2158
y(b)o(ut)i(is)g(older)h(than)f(one)h(of)f(its)g(dependencies)h(\(so)f
(that)g(one)h(of)g(its)f(dependencies)g(was)h(changed)f(after)i(it)e
(was)50 2215 y(last)f(updated\),)i(the)f(actions)g(of)g(the)g(rule)g
(are)h(e)o(x)o(ecuted)g(to)f(create)h(or)f(update)g(that)g(tar)o(get.)
25 b(The)14 b(program)g(will)50 2271 y(complain)9 b(if)i(an)o(y)g
(dependenc)o(y)f(does)h(not)f(e)o(xist)g(and)g(there)h(is)f(no)g(rule)h
(for)g(creating)f(it.)16 b(T)l(o)11 b(start)f(the)g(process)h(of)o(f,)
50 2327 y(the)h(user)g(who)g(e)o(x)o(ecutes)h(the)f Fk(gmake)i
Fm(utility)c(speci\256es)j(one)f(or)g(more)g(tar)o(gets)g(to)g(be)g
(updated.)19 b(The)12 b(\256rst)g(tar)o(get)50 2384 y(of)f(the)g
(\256rst)h(rule)f(in)g(the)h(\256le)f(is)g(the)g(default.)120
2441 y(In)i(the)f(e)o(xample)g(abo)o(v)o(e,)h Fk(edit)h
Fm(is)d(the)h(default)g(tar)o(get.)19 b(The)12 b(\256rst)h(step)e(in)h
(updating)f(it)h(is)f(to)h(update)g(all)g(the)50 2497
y(object)e(\()p Fk(.o)p Fm(\))h(\256les)g(listed)e(as)h(dependencies.)
17 b(T)l(o)10 b(update)g Fk(edit.o)p Fm(,)j(in)d(turn,)h(requires)f
(\256rst)h(that)e Fk(edit.cc)k Fm(and)50 2554 y Fk(defs.h)h
Fm(be)f(updated.)19 b(Presumably)m(,)12 b Fk(edit.cc)j
Fm(is)d(the)g(source)h(\256le)f(that)g(produces)g Fk(edit.o)j
Fm(and)d Fk(defs.h)p eop
%%Page: 41 3
41 2 bop 75 50 a Fc(Basic)12 b(Compilation)d(Control)i(with)g
Fk(Gmake)1061 b Fm(41)75 199 y(is)9 b(a)h(header)g(\256le)g(that)f
Fk(edit.cc)j Fm(includes.)k(There)10 b(are)g(no)g(rules)f(tar)o(geting)
g(these)h(\256les;)g(therefore,)h(the)o(y)e(merely)75
256 y(need)16 b(to)g(e)o(xist)g(to)g(be)g(up-to-date.)31
b(No)o(w)16 b Fk(edit.o)i Fm(is)e(up-to-date)g(if)g(it)g(is)f(younger)h
(than)g(either)g Fk(edit.cc)75 312 y Fm(or)e Fk(defs.h)j
Fm(\(if)d(it)g(were)h(older)n(,)h(it)e(would)f(mean)h(that)g(one)g(of)h
(those)e(\256les)i(had)f(been)h(changed)f(since)h(the)f(last)75
369 y(compilation)8 b(that)i(produced)h Fk(edit.o)p Fm(\).)19
b(If)11 b Fk(edit.o)i Fm(is)d(older)g(than)h(its)e(dependencies,)i
Fk(gmake)i Fm(e)o(x)o(ecutes)e(the)75 425 y(action)j(\252)p
Fk(g++)29 b(-g)f(-c)g(-Wall)i(edit.cc)p Fm(\272,)19 b(producing)14
b(a)g(ne)o(w)h Fk(edit.o)p Fm(.)29 b(Once)15 b Fk(edit.o)i
Fm(and)e(all)f(the)75 482 y(other)g Fk(.o)h Fm(\256les)f(are)i
(updated,)f(the)o(y)f(are)h(combined)e(by)h(the)g(action)g(\252)p
Fk(g++)29 b(-g)f(-o)h(edit)g Fb(\001)8 b(\001)g(\001)n
Fm(\272)14 b(to)g(produce)75 538 y(the)c(program)g Fk(edit)p
Fm(,)i(if)f(either)f Fk(edit)i Fm(does)e(not)g(already)g(e)o(xist)g(or)
h(if)f(an)o(y)g(of)h(the)f Fk(.o)h Fm(\256les)f(are)i(younger)d(than)h
(the)75 594 y(e)o(xisting)g Fk(edit)j Fm(\256le.)145
651 y(T)l(o)f(in)n(v)o(oke)e Fk(gmake)k Fm(for)d(this)g(e)o(xample,)h
(one)f(issues)f(the)i(command)257 739 y Fk(gmake)29 b(-f)f
Fj(make\256le-name)g(tar)n(get-names)75 828 y Fm(where)15
b(the)g Fj(tar)n(get-names)f Fm(are)i(the)e(tar)o(gets)h(that)g(you)f
(wish)h(to)f(update)h(and)g(the)f Fj(make\256le-name)h
Fm(gi)o(v)o(en)g(in)f(the)75 884 y Fk(-f)g Fm(switch)e(is)h(the)g(name)
g(of)h(the)f(make\256le.)22 b(By)13 b(default,)h(the)f(tar)o(get)g(is)g
(that)g(of)g(the)g(\256rst)h(rule)f(in)g(the)g(\256le.)23
b(Y)-5 b(ou)75 941 y(may)13 b(\(and)g(usually)f(do\))i(lea)o(v)o(e)g
(of)o(f)f Fk(-f)h Fj(make\256le-name)p Fm(,)g(in)f(which)g(case)h(it)f
(defaults)f(to)h(either)h Fk(makefile)i Fm(or)75 997
y Fk(Makefile)p Fm(,)j(whiche)o(v)o(er)c(e)o(xists.)26
b(It)15 b(is)f(typical)g(to)g(arrange)i(that)e(each)h(directory)g
(contains)f(the)g(source)h(code)75 1054 y(for)h(a)h(single)e(principal)
h(program.)31 b(By)17 b(adopting)e(the)h(con)n(v)o(ention)g(that)g(the)
g(rule)g(with)g(that)g(program)g(as)g(its)75 1110 y(tar)o(get)10
b(goes)f(\256rst,)i(and)f(that)g(the)f(make\256le)h(for)g(the)g
(directory)g(is)f(named)h Fk(makefile)p Fm(,)k(you)9
b(can)i(arrange)f(that,)h(by)75 1167 y(con)n(v)o(ention,)e(issuing)f
(the)h(command)f Fk(gmake)k Fm(with)c(no)h(ar)o(guments)g(in)g(an)o(y)g
(directory)g(will)g(update)g(the)g(principal)75 1223
y(program)i(of)g(that)g(directory)m(.)145 1280 y(It)g(is)e(possible)g
(to)h(ha)o(v)o(e)h(more)g(than)f(one)g(rule)g(with)g(the)g(same)g(tar)o
(get,)i(as)e(long)g(as)g(no)g(more)g(than)g(one)h(rule)f(for)75
1336 y(each)i(tar)o(get)f(has)h(an)f(action.)17 b(Thus,)11
b(we)g(can)h(also)f(write)g(the)h(latter)f(part)g(of)h(the)f(e)o
(xample)g(abo)o(v)o(e)i(as)e(follo)o(ws.)184 1424 y Fk(edit.o)30
b(:)e(edit.cc)403 1481 y(g++)h(-g)f(-c)g(-Wall)i(edit.cc)184
1537 y(kbd.o)g(:)d(kbd.cc)403 1594 y(g++)i(-g)f(-c)g(-Wall)i(kbd.cc)184
1650 y(commands.)q(o)h(:)c(command.)q(cc)403 1707 y(g++)i(-g)f(-c)g
(-Wall)i(commands.c)q(c)184 1763 y(display.o)h(:)d(display.c)q(c)403
1820 y(g++)h(-g)f(-c)g(-Wall)i(display.cc)184 1876 y(insert.o)h(:)d
(insert.cc)403 1933 y(g++)h(-g)f(-c)g(-Wall)i(insert.cc)184
1989 y(search.o)h(:)d(search.cc)403 2045 y(g++)h(-g)f(-c)g(-Wall)i
(search.cc)184 2102 y(files.o)g(:)e(files.cc)403 2158
y(g++)h(-g)f(-c)g(-Wall)i(files.cc)184 2215 y(utils.o)g(:)e(utils.cc)
403 2271 y(g++)h(-g)f(-c)g(-Wall)i(utils.cc)184 2384
y(edit.o)g(kbd.o)f(commands)q(.o)i(display.o)g(\\)294
2441 y(insert.o)f(search.o)h(files.o)f(utils.o:)h(defs.h)184
2497 y(kbd.o)f(commands.o)h(files.o)f(:)e(command.h)184
2554 y(display.o)j(insert.o)g(search.o)f(files.o)h(:)c(buffer.h)p
eop
%%Page: 42 4
42 3 bop 50 50 a Fm(42)1527 b Fc(P)-5 b(.)13 b(N.)e(Hil\256nger)50
199 y Fm(The)e(order)h(in)f(which)g(these)h(rules)f(are)h(written)f(is)
g(irrele)o(v)o(ant.)16 b(Which)9 b(order)h(or)g(grouping)e(you)h
(choose)g(is)g(lar)o(gely)50 256 y(a)j(matter)f(of)g(taste.)120
314 y(The)17 b(e)o(xample)f(of)g(this)g(section)f(illustrates)g(the)h
(concepts)g(underlying)f Fk(gmake)p Fm(.)34 b(The)16
b(rest)h(of)f Fk(gmake)p Fm(')m(s)50 370 y(features)c(e)o(xist)f
(mostly)e(to)i(enhance)h(the)g(con)n(v)o(enience)g(of)f(using)g(it.)50
506 y Fh(2)50 b(V)-5 b(ariables)50 597 y Fm(The)13 b(dependencies)h(of)
f(the)h(tar)o(get)f Fk(edit)i Fm(in)e Fb(x)q Fm(1)g(are)h(also)f(the)g
(ar)o(guments)g(to)g(the)h(command)e(that)h(links)g(them.)50
653 y(One)e(can)h(a)o(v)o(oid)f(this)g(redundanc)o(y)g(by)g(de\256ning)
g(a)h(v)o(ariable)g(that)e(contains)h(the)g(names)g(of)h(all)f(object)g
(\256les.)159 756 y Fk(#)28 b(Makefile)j(for)d(simple)i(editor)159
869 y(OBJS)f(=)f(edit.o)i(kbd.o)f(commands)q(.o)i(display.o)g(\\)351
925 y(insert.o)g(search.o)f(files.o)h(utils.o)159 1038
y(edit)e(:)f($\(OBJS\))379 1094 y(g++)g(-g)g(-o)h(edit)g($\(OBJS\))50
1195 y Fm(The)12 b(\(continued\))f(line)h(be)o(ginning)f(\252)p
Fk(OBJS)29 b(=)p Fm(\272)13 b(de\256nes)f(the)g(v)o(ariable)g
Fk(OBJS)p Fm(,)i(which)e(can)g(later)h(be)f(referenced)50
1252 y(as)j(\252$\(OBJS\)\272)i(or)e(\252$)p Fb(f)p Fm(OBJS)p
Fb(g)p Fm(\272.)29 b(These)16 b(later)f(references)i(cause)f(the)f
(de\256nition)f(of)i Fk(OBJ)g Fm(to)f(be)g(substituted)50
1308 y(v)o(erbatim)d(before)h(the)f(rule)g(is)f(processed.)20
b(It)12 b(is)g(some)o(what)f(unfortunate)g(that)h(both)g
Fk(gmake)i Fm(and)e(the)g(shell)f(use)50 1365 y(`$')h(to)f(pre\256x)h
(v)o(ariable)f(references;)i Fk(gmake)g Fm(de\256nes)f(`$$')f(to)g(be)h
(simply)e(`$',)i(thus)f(allo)o(wing)f(you)h(to)g(send)g(`$')m(s)50
1421 y(to)g(the)g(shell,)g(where)h(needed.)120 1479 y(Y)-5
b(ou)10 b(will)g(sometimes)e(\256nd)j(that)e(you)h(need)h(a)f(v)o(alue)
g(that)g(is)g(just)f(like)g(that)h(of)g(some)g(v)o(ariable,)h(with)f(a)
g(certain)50 1536 y(systematic)g(substitution.)k(F)o(or)e(e)o(xample,)g
(gi)o(v)o(en)e(a)i(v)o(ariable)f(listing)f(the)h(names)g(of)g(all)g
(source)g(\256les,)h(you)f(might)50 1592 y(want)i(to)g(get)h(the)g
(names)f(of)h(all)g(resulting)f Fk(.o)h Fm(\256les.)25
b(W)l(e)14 b(can)g(re)o(write)h(the)e(de\256nition)g(of)h(OBJS)h(abo)o
(v)o(e)f(to)g(get)50 1649 y(this.)141 1750 y Fk(SRCS)29
b(=)f(edit.cc)i(kbd.cc)g(commands.c)q(c)h(display.cc)g(\\)333
1806 y(insert.cc)g(search.cc)g(files.cc)f(utils.cc)141
1862 y(OBJS)f(=)f($\(SRCS:.cc)q(=.)q(o\))50 1963 y Fm(The)10
b(substitution)d(suf)o(\256x)k(`)p Fk(:.cc=.o)p Fm(')i(speci\256es)d
(the)g(desired)h(substitution.)i(W)l(e)e(no)o(w)f(ha)o(v)o(e)h(v)o
(ariables)f(for)g(both)50 2020 y(the)i(names)g(of)g(all)g(sources)g
(and)g(the)g(names)g(of)g(all)g(object)f(\256les)i(without)d(ha)o(ving)
i(to)f(repeat)i(a)g(lot)e(of)h(\256le)h(names)50 2076
y(\(and)e(possibly)f(make)h(a)h(mistake\).)120 2135 y(V)-5
b(ariables)12 b(may)f(also)g(be)g(set)g(in)g(the)g(command)f(line)h
(that)g(in)n(v)o(okes)f Fk(gmake)p Fm(.)19 b(F)o(or)12
b(e)o(xample,)g(if)f(the)h(make\256le)50 2191 y(contains)159
2294 y Fk(edit.o:)31 b(edit.cc)379 2350 y(g++)d($\(DEBUG\))j(-c)d
(-Wall)h(edit.cc)50 2451 y Fm(Then)11 b(a)h(command)e(such)h(as)159
2554 y Fk(gmake)30 b(DEBUG=-g)g(...)p eop
%%Page: 43 5
43 4 bop 75 50 a Fc(Basic)12 b(Compilation)d(Control)i(with)g
Fk(Gmake)1061 b Fm(43)75 199 y(will)8 b(cause)i(the)f(compilations)e
(to)i(use)g(the)g Fk(-g)h Fm(\(add)f(symbolic)f(deb)o(ugging)g
(information\))g(switch,)h(while)g(lea)o(ving)75 256
y(of)o(f)14 b(the)g Fk(DEBUG=-g)k Fm(will)13 b(not)h(use)g(the)g
Fk(-g)h Fm(switch.)25 b(V)-5 b(ariable)14 b(de\256nitions)g(in)f(the)h
(command)g(lines)f(o)o(v)o(erride)75 312 y(those)e(in)f(the)i
(make\256le,)f(which)g(allo)o(ws)g(the)g(make\256le)g(to)g(supply)f
(defaults.)145 369 y(V)-5 b(ariables)14 b(not)g(set)f(by)h(either)g(of)
g(these)g(methods)f(may)g(be)h(set)g(as)g(UNIX)g(en)n(vironment)f(v)o
(ariables.)24 b(Thus,)75 426 y(the)11 b(sequence)h(of)f(commands)184
522 y Fk(setenv)30 b(DEBUG)f(-g)184 578 y(gmake)h(...)75
674 y Fm(for)11 b(this)g(last)g(e)o(xample)g(will)g(also)f(use)i(the)f
Fk(-g)h Fm(switch)f(during)f(compilations.)75 801 y Fh(3)49
b(Implicit)13 b(rules)75 889 y Fm(In)c(the)f(e)o(xample)h(from)g
Fb(x)p Fm(1,)h(all)f(of)g(the)f(compilations)f(that)i(produced)f
Fk(.o)i Fm(\256les)f(ha)o(v)o(e)h(the)e(same)h(form.)16
b(It)9 b(is)f(tedious)75 946 y(to)k(ha)o(v)o(e)i(to)e(duplicate)g
(them;)h(it)f(merely)h(gi)o(v)o(es)g(you)f(the)h(opportunity)e(to)h
(type)h(something)e(wrong.)21 b(Therefore,)75 1002 y
Fk(gmake)14 b Fm(can)f(be)f(told)g(about\320and)f(for)i(some)f
(standard)g(cases,)h(already)g(kno)o(ws)f(about\320the)f(default)h
(\256les)g(and)75 1059 y(actions)h(needed)i(to)e(produce)i(\256les)f
(ha)o(ving)g(v)o(arious)f(e)o(xtensions.)24 b(F)o(or)15
b(our)f(purposes,)h(the)f(most)f(important)g(is)75 1115
y(that)e(it)g(kno)o(ws)g(ho)o(w)h(to)f(produce)h(a)g(\256le)g
Fa(F)6 b Fk(.o)14 b Fm(gi)o(v)o(en)d(a)h(\256le)g(of)g(the)g(form)g
Fa(F)6 b Fk(.cc)p Fm(,)14 b(and)e(kno)o(ws)f(that)g(the)h
Fa(F)6 b Fk(.o)13 b Fm(\256le)75 1172 y(depends)e(on)g(the)g(\256le)h
Fa(F)6 b Fk(.cc)p Fm(.)18 b(Speci\256cally)m(,)13 b Fk(gmake)g
Fm(automatically)d(introduces)h(\(in)g(ef)o(fect\))i(the)e(rule)166
1267 y Fa(F)6 b Fk(.o)29 b(:)f Fa(F)6 b Fk(.cc)385 1324
y($\(CXX\))30 b(-c)e(-Wall)i($\(CXXFLAGS)q(\))g Fa(F)6
b Fk(.cc)75 1419 y Fm(when)11 b(called)g(upon)f(to)g(produce)h
Fa(F)6 b Fk(.o)12 b Fm(when)f(there)g(is)g(a)g(C++)g(\256le)g
Fa(F)6 b Fk(.cc)13 b Fm(present,)e(b)o(ut)g(no)f(e)o(xplicitly)g
(speci\256ed)75 1476 y(actions)i(e)o(xist)g(for)h(producing)e
Fa(F)6 b Fk(.o)p Fm(.)22 b(The)12 b(use)h(of)f(the)h(pre\256x)g
(\252CXX\272)g(is)f(a)h(naming)f(con)n(v)o(ention)g(for)h(v)o(ariables)
75 1532 y(that)e(ha)o(v)o(e)h(to)f(do)g(with)f(C++.)17
b(It)11 b(also)g(creates)i(the)e(command)166 1628 y Fa(F)34
b Fk(:)28 b Fa(F)6 b Fk(.o)385 1684 y($\(CXX\))30 b($\(LDFLAGS)q(\))g
Fa(F)6 b Fk(.o)29 b($\(LOADLIB)q(ES\))i(-o)d Fa(F)75
1780 y Fm(to)11 b(tell)f(ho)o(w)h(to)g(create)i(an)e(e)o(x)o(ecutable)i
(\256le)e(named)g Fa(F)18 b Fm(from)12 b Fa(F)6 b Fk(.o)p
Fm(.)145 1837 y(As)11 b(a)h(result,)f(we)h(may)f(abbre)o(viate)h(the)f
(e)o(xample)g(as)h(follo)o(ws.)184 1933 y Fk(#)28 b(Makefile)j(for)d
(simple)i(editor)184 2045 y(SRCS)f(=)f(edit.cc)i(kbd.cc)g(commands.)q
(cc)h(display.cc)g(\\)376 2102 y(insert.cc)g(search.cc)g(files.cc)g
(utils.cc)184 2215 y(OBJS)e(=)f($\(SRCS:.c)q(c=.)q(o\))184
2328 y(CC)h(=)e(gcc)184 2441 y(CXX)i(=)f(g++)184 2554
y(CXXFLAGS)j(=)d(-g)p eop
%%Page: 44 6
44 5 bop 50 50 a Fm(44)1527 b Fc(P)-5 b(.)13 b(N.)e(Hil\256nger)159
256 y Fk(LOADLIBE)q(S)30 b(=)e(-lm)159 369 y(edit)h(:)f($\(OBJS\))159
425 y(edit.o)i(:)e(defs.h)159 482 y(kbd.o)i(:)e(defs.h)h(command.)q(h)
159 538 y(commands)q(.o)i(:)d(defs.h)h(command.)q(h)159
594 y(display.)q(o)h(:)e(defs.h)i(buffer.h)159 651 y(insert.o)h(:)d
(defs.h)i(buffer.h)159 707 y(search.o)h(:)d(defs.h)i(buffer.h)159
764 y(files.o)h(:)c(defs.h)j(buffer.h)h(command.h)159
820 y(utils.o)g(:)c(defs.h)50 920 y Fm(There)13 b(are)h(quite)f(a)g(fe)
o(w)g(other)g(such)g(implicit)e(rules)i(b)o(uilt)f(into)g
Fk(gmake)p Fm(.)24 b(The)13 b Fk(-p)h Fm(switch)f(will)f(cause)h
Fk(gmake)50 977 y Fm(to)g(list)f(them)g(some)o(what)g(cryptically)m(,)i
(if)f(you)g(are)h(at)f(all)g(curious.)22 b(W)l(e)13 b(are)h(most)e
(likely)g(to)h(be)g(using)g(the)g(rules)50 1033 y(for)e(creating)h
Fk(.o)g Fm(\256les)f(from)g Fk(.cc)h Fm(\(C++\))g(\256les.)17
b(It)11 b(is)g(also)g(possible)f(to)g(supply)g(your)h(o)o(wn)g(default)
g(rules)g(and)g(to)50 1090 y(suppress)f(the)h(standard)g(rules;)g(for)g
(details,)g(see)h(the)f(full)f(documentation,)g(which)h(is)g(a)o(v)o
(ailable)g(on)g(our)g(systems)50 1146 y(through)f(the)h
Fk(C-h)29 b(i)12 b Fm(command)e(in)h(Emacs.)50 1280 y
Fh(4)50 b(Special)11 b(actions)50 1371 y Fm(It)i(is)f(often)g(useful)h
(to)f(ha)o(v)o(e)i(tar)o(gets)e(for)h(which)g(there)g(are)g(ne)o(v)o
(er)h(an)o(y)f(corresponding)f(\256les.)21 b(If)13 b(the)g(actions)f
(for)50 1427 y(a)g(tar)o(get)f(do)g(not)g(create)i(a)e(\256le)h(by)f
(that)g(name,)h(it)f(follo)o(ws)f(from)h(the)h(de\256nition)e(of)i(ho)o
(w)f Fk(gmake)i Fm(works)e(that)g(the)50 1484 y(actions)h(for)h(that)f
(tar)o(get)h(will)f(be)h(e)o(x)o(ecuted)h(each)f(time)f
Fk(gmake)j Fm(is)e(applied)f(to)g(that)g(tar)o(get.)22
b(A)13 b(common)e(use)i(is)50 1540 y(to)f(put)g(a)g(standard)h
(\252clean-up\272)g(operation)f(into)f(each)i(of)g(your)f(make\256les,)
h(specifying)e(ho)o(w)h(to)g(get)h(rid)f(of)g(\256les)50
1597 y(that)f(can)h(be)f(reconstructed,)h(if)f(necessary)m(.)18
b(F)o(or)12 b(e)o(xample,)g(you)e(will)h(often)g(see)h(a)g(rule)f(like)
g(this)f(in)h(a)h(make\256le.)159 1698 y Fk(clean:)379
1755 y(rm)28 b(-f)g(*.o)50 1855 y Fm(Ev)o(ery)13 b(time)f(you)g(issue)g
(the)h(shell)f(command)g Fk(gmake)29 b(clean)p Fm(,)16
b(this)c(action)g(will)g(e)o(x)o(ecute,)j(remo)o(ving)d(all)h
Fk(.o)50 1911 y Fm(\256les.)120 1969 y(Another)e(possible)e(use)h(is)g
(to)g(pro)o(vide)h(a)g(standard)f(way)g(to)g(run)h(a)g(set)f(of)h
(tests)e(on)i(your)f(program\320what)g(are)50 2026 y(typically)j(kno)o
(wn)g(as)h Fj(r)n(e)n(gr)n(ession)f(tests)p Fm(\320to)f(see)j(that)e
(it)g(is)h(working)f(and)g(has)h(not)f(\252re)o(gressed\272)j(as)e(a)g
(result)f(of)50 2082 y(some)e(change)g(you')n(v)o(e)h(made.)k(F)o(or)d
(e)o(xample,)e(to)g(cause)h(the)f(command)141 2182 y
Fk(make)29 b(test)50 2283 y Fm(to)11 b(feed)h(a)f(test)g(\256le)h
(through)f(our)g(editor)g(program)g(and)g(check)h(that)f(it)g(produces)
g(the)g(right)g(result,)g(use:)159 2384 y Fk(test:)30
b(edit)269 2441 y(rm)e(-f)g(test-fil)q(e1)269 2497 y(./edit)i(<)e
(test-comma)q(nds)q(1)269 2554 y(diff)h(test-file)q(1)h(expected)q(-te)
q(st)q(-fi)q(le1)p eop
%%Page: 45 7
45 6 bop 75 50 a Fc(Basic)12 b(Compilation)d(Control)i(with)g
Fk(Gmake)1061 b Fm(45)75 199 y(where)13 b(the)g(\256le)g
Fk(test-comma)q(nds)q(1)j Fm(presumably)c(contains)g(editor)g(commands)
f(that)i(are)g(supposed)f(to)g(pro-)75 256 y(duce)h(a)g(\256le)g
Fk(test-file)q(1)p Fm(,)j(and)d(the)g(\256le)g Fk(expected-t)q(es)q
(t-f)q(il)q(e1)j Fm(contains)c(what)h(is)f(supposed)g(to)g(be)75
312 y(in)h Fk(test-file1)k Fm(after)d(e)o(x)o(ecuting)f(those)g
(commands.)21 b(The)14 b(\256rst)f(action)g(line)g(of)g(the)g(rule)h
(clears)f(a)o(way)h(an)o(y)75 369 y(old)d(copy)g(of)g
Fk(test-fil)q(e1)p Fm(;)k(the)c(second)h(runs)f(the)h(editor)f(and)g
(feeds)h(in)f Fk(test-com)q(man)q(ds)q(1)k Fm(through)10
b(the)75 425 y(standard)f(input,)g(and)g(the)g(third)f(compares)h(the)g
(resulting)f(\256le)i(with)e(its)h(e)o(xpected)g(contents.)16
b(If)9 b(either)g(the)g(second)75 482 y(or)i(third)g(action)g(fails,)g
Fk(make)i Fm(will)d(report)i(that)f(it)g(encountered)g(an)h(error)m(.)
145 538 y(Figure)7 b(1)g(illustrates)g(a)g(more)g(general)g(set-up.)14
b(Here,)9 b(the)e(make\256le)g(de\256nes)g(the)g(v)o(ariable)g(TESTPR)n
(OGRAM)75 594 y(to)k(be)g(the)g(name)h(of)f(an)o(y)h(arbitrary)g
(testing)e(command,)h(and)g(TESTS)h(to)f(be)h(a)f(list)g(of)g(ar)o
(gument)g(sets)g(to)g(gi)o(v)o(e)g(the)75 651 y(test)f(program.)17
b(The)11 b(make\256le)f(also)h(includes)f(the)h(template)f(sho)o(wn)g
(in)h(the)g(\256gure.)17 b(Suppose)11 b(that)f(my)g(make\256le)75
707 y(includes)g(this)h(template)f(and)i(also)f(the)g(de\256nitions)166
792 y Fk(TESTPROGR)q(AM)31 b(=)d(./test-edi)q(t)166 905
y(TESTS)h(=)f("test-com)q(ma)q(nds)q(1)j(test-file1)g(expected-)q(tes)q
(t-)q(fil)q(e1")g(\\)385 961 y("test-com)q(ma)q(nds)q(2)g(test-file2)g
(expected-)q(tes)q(t-)q(fil)q(e2")75 1046 y Fm(Then)11
b Fk(gmake)29 b(test)13 b Fm(will)e(run)166 1130 y Fk(./test-ed)q(it)31
b(test-comma)q(nd)q(s1)g(test-file1)g(expected-)q(te)q(st-)q(fil)q(e1)
166 1187 y(./test-ed)q(it)g(test-comma)q(nd)q(s2)g(test-file2)g
(expected-)q(te)q(st-)q(fil)q(e2)75 1271 y Fm(and)11
b(will)g(report)g(which)g(tests)g(succeed)h(and)f(which)g(fail.)16
b(The)c(script)f Fk(test-edit)k Fm(in)10 b(this)h(case)h(could)f(be)166
1356 y Fk(#!/bin/sh)166 1412 y(#)28 b($1:)g(command)j(file.)e($2:)g
(output)g(file.)166 1468 y(#)f($3:)g(standard)j(for)e(the)f(output)i
(file.)166 1525 y(rm)e(-f)g($2)166 1581 y(#)g(The)g(followin)q(g)i
(command)h(runs)e(the)f(editor)i(and)f(compares)h(the)f(output)166
1638 y(#)f(against)i(the)f(standard.)58 b(This)29 b(script)h(returns)g
(normally)g(if)f(the)f(editor)166 1694 y(#)g(returns)i(normally)h(and)d
(diff)h(finds)h(no)e(difference)q(s.)166 1751 y(./edit)i(<)e($1)g(&&)g
(diff)h($2)f($3)75 1835 y Fm(Of)12 b(course,)g(doing)f(things)g(this)g
(fanc)o(y)h(requires)g(that)f(you)g(learn)i(a)f(fair)g(amount)e(about)i
(the)f(shell)h(language)f(\(the)75 1892 y(Bourne)h(shell,)f(in)g(this)f
(case\).)145 1948 y(The)k(de\256nition)e(of)h(the)h Fk(test)h
Fm(tar)o(get)e(in)g(Figure)g(1)h(illustrates)e(the)h(adv)o(anced)g(use)
h(of)f(shell)f(commands)h(in)75 2005 y(a)i(make\256le.)27
b(Because)16 b(the)f(action)f(is)h(a)g(single)f(\(compound\))g(shell)g
(command\320a)g(loop\320you)f(must)h(inform)75 2061 y
Fk(gmake)g Fm(not)e(to)g(break)h(it)f(into)f(7)h(separate)h(commands;)f
(that')m(s)g(the)g(purpose)g(of)h(the)f(backslashes)g(at)h(the)f(end)g
(of)75 2117 y(each)i(line.)24 b(Also,)15 b(in)e(an)h(ordinary)g(shell)f
(script,)i(I')n(d)f(write)g Fk(${test})i Fm(rather)f(than)e
Fk($${test})q Fm(.)27 b(Ho)o(we)o(v)o(er)n(,)75 2174
y Fk(gmake)16 b Fm(treats)e Fk($)g Fm(as)g(a)h(special)f(character;)i
(to)e(a)o(v)o(oid)g(confusion,)g Fk(gmake)i Fm(treats)e
Fk($$)h Fm(as)f(a)g(single)f(dollar)h(sign)75 2230 y(that)d(is)g
(supposed)f(to)h(be)g(included)g(in)g(the)g(command.)75
2353 y Fh(5)49 b(Details)13 b(of)e(actions)75 2441 y
Fm(By)16 b(default,)g(each)h(action)e(line)g(speci\256ed)h(in)f(a)h
(rule)g(is)f(e)o(x)o(ecuted)i(by)e(the)g(Bourne)h(shell)f(\(as)h
(opposed)f(to)g(the)75 2497 y(C)f(shell,)f(which,)h(most)e
(unfortunately)m(,)h(is)g(more)g(commonly)f(used)h(here\).)24
b(F)o(or)14 b(the)f(simple)f(make\256les)h(we)g(are)75
2554 y(likely)d(to)h(use,)g(this)g(will)f(make)h(little)f(dif)o
(ference,)j(b)o(ut)e(be)g(prepared)i(for)e(surprises)g(if)g(you)g(get)g
(ambitious.)p eop
%%Page: 46 8
46 7 bop 50 50 a Fm(46)1527 b Fc(P)-5 b(.)13 b(N.)e(Hil\256nger)120
199 y Fm(The)i Fk(gmake)h Fm(program)e(usually)f(prints)g(each)i
(action)f(as)g(it)g(is)f(e)o(x)o(ecuted,)j(b)o(ut)e(there)g(are)h
(times)f(when)g(this)f(is)50 256 y(not)e(desirable.)16
b(Therefore,)c(a)e(`@')g(character)i(at)d(the)h(be)o(ginning)f(of)h(an)
g(action)f(suppresses)g(the)h(default)f(printing.)50
312 y(Here)j(is)f(an)g(e)o(xample)h(of)f(a)h(common)e(use.)159
422 y Fk(edit)29 b(:)f($\(OBJS\))379 478 y(@echo)h(Linking)h(edit)f
(...)379 535 y(@g++)g(-g)f(-o)g(edit)h($\(OBJS\))379
591 y(@echo)g(Done)50 698 y Fm(The)10 b(result)h(of)f(these)h(actions)f
(is)g(that)g(when)g Fk(gmake)j Fm(e)o(x)o(ecutes)f(this)d(\256nal)i
(editing)e(step)i(for)g(the)f Fk(edit)i Fm(program,)50
754 y(the)f(only)f(thing)g(you'll)f(see)i(printed)g(is)f(a)h(line)g
(reading)g(\252)p Fk(Linking)30 b(edit...)p Fm(\272)20
b(and,)11 b(at)g(the)g(end)g(of)g(the)f(step,)50 811
y(a)i(line)e(reading)i(\252)p Fk(Done)p Fm(\272.)120
870 y(When)j Fk(gmake)h Fm(encounters)e(an)h(action)f(that)f(returns)i
(a)f(non-zero)h(e)o(xit)f(code,)i(the)e(UNIX)g(con)n(v)o(ention)g(for)
50 927 y(indicating)9 b(an)i(error)n(,)g(its)f(standard)g(response)h
(is)e(to)h(end)h(processing)f(and)g(e)o(xit.)16 b(The)11
b(error)g(codes)f(of)h(action)f(lines)50 983 y(that)j(be)o(gin)g(with)g
(a)g(`-')i(sign)d(\(possibly)g(preceded)i(by)g(a)f(`@'\))h(are)h
(ignored.)22 b(Also,)14 b(the)f Fk(-k)i Fm(switch)d(to)h
Fk(gmake)50 1040 y Fm(will)f(cause)h(it)g(to)f(abandon)h(processing)f
(only)g(of)h(the)g(current)g(rule)g(\(and)g(an)o(y)h(that)e(depend)h
(on)g(its)f(tar)o(get\))h(upon)50 1096 y(encountering)e(an)g(error)n(,)
i(allo)o(wing)d(processing)h(of)g(\252sibling\272)f(rules)i(to)f
(proceed.)50 1240 y Fh(6)50 b(Cr)o(eating)11 b(make\256les)50
1334 y Fm(A)k(good)f(way)h(to)g(create)h(make\256les)e(is)h(to)g(ha)o
(v)o(e)g(a)h(template)e(that)h(you)f(include)h(in)f(your)h(particular)g
(make\256le.)50 1390 y(Something)10 b(like)f(the)i(e)o(xample)g(in)f
(Figure)h(1,)h(for)f(e)o(xample.)17 b(Y)-5 b(ou)10 b(ha)o(v)o(e)h(one)g
(or)g(more)g(of)g(these)f(for)i(v)o(arious)e(uses)50
1447 y(\(C++)h(programs,)g(Ja)o(v)o(a)g(programs,)g(etc.\).)17
b(F)o(or)12 b(an)o(y)f(particular)g(program,)g(your)g(make\256le)f
(might)g(then)g(look)g(like)50 1503 y(the)h(follo)o(wing)f(e)o(xample:)
141 1610 y Fk(PROGRAM)30 b(=)e(edit)141 1723 y(CXX_SRCS)j(=)d(edit.cc)i
(kbd.cc)f(commands)q(.cc)i(display.c)q(c)g(\\)443 1779
y(insert.cc)f(search.c)q(c)g(files.cc)h(utils.cc)141
1892 y(include)f($\(HOME\)/l)q(ib)q(/Ma)q(ke)q(fil)q(e.)q(std)50
1999 y Fm(W)l(e)13 b(will)e(maintain)g(a)h(template)g(like)f(this)g(in)
h Fk($MASTERDIR)q(/l)q(ib/)q(Ma)q(kef)q(il)q(e.s)q(td)q
Fm(,)j(which)d(you)g(include)50 2055 y(with)141 2162
y Fk(include)30 b($\(MASTERD)q(IR)q(\)/l)q(ib)q(/Ma)q(ke)q(fil)q(e.)q
(std)50 2268 y Fm(\(always)17 b(assuming,)h(that)g(is,)h(that)f(you)f
(use)h(the)g(standard)f(class)h(setup)f(\256les,)j(which)e(set)g(the)f
(en)n(vironment)50 2325 y(v)o(ariables)11 b(MASTER)h(and)f(MASTERDIR)h
(to)f(the)g(CS61B)i(home)e(directory)m(.\))120 2384 y(As)g(a)h(\256nal)
f(con)n(v)o(enience,)i(the)e Fk(-MM)i Fm(option)d(to)g
Fk(gcc)j Fm(creates)f(dependenc)o(y)g(lines)e(for)i(C)f(and)h(C++)f
(automat-)50 2441 y(ically)m(.)29 b(The)15 b(template)g(sho)o(wn)f(in)i
(Figure)f(1)h(uses)f(this)f(to)h(automatically)f(generate)j(a)e(\256le)
h(of)g(dependencies.)50 2497 y(modi\256ed)j(make\256le.)40
b(The)20 b Fk(depend)i Fm(special)d(tar)o(get)h(in)f(in)g(that)g
(\256le)g(allo)o(ws)g(you)g(to)g(recreate)i(the)e(set)g(of)50
2554 y(dependencies)11 b(when)h(needed)f(by)g(typing)f(`)p
Fk(gmake)30 b(depend)p Fm('.)p eop
%%Page: 47 9
47 8 bop 75 50 a Fc(Basic)12 b(Compilation)d(Control)i(with)g
Fk(Gmake)1061 b Fm(47)149 206 y Fe(#)23 b(Standard)j(definitio)q(ns)g
(for)e(make)g(utility:)h(C++)f(version.)149 297 y(#)f(Assumes)j(that)e
(this)g(file)g(is)f(included)j(from)e(a)f(Makefile)i(that)g(defines)149
343 y(#)e(PROGRAM)j(to)d(be)g(the)h(name)g(of)f(the)h(program)h(to)e
(be)h(created)h(and)f(CXX_SRCS)149 389 y(#)f(to)h(the)f(list)h(of)g
(C++)f(source)i(files)g(that)f(go)f(into)h(it.)149 434
y(#)f(The)h(including)i(Makefile)g(may)e(subsequent)q(ly)i(override)g
(CXXFLAGS)f(\(flags)g(to)149 480 y(#)e(the)h(C++)g(compiler\),)i
(LOADLIBE)q(S)f(\(-l)f(options)h(for)f(the)g(linker\),)h(LDFLAGS)149
526 y(#)e(\(flags)i(to)e(the)h(linker\),)i(and)e(CXX)f(\(the)h(C++)g
(compiler\))q(.)149 617 y(#)f(Targets)j(defined:)149
663 y(#)91 b(all:)g(Default)25 b(entry.)48 b(Compiles)25
b(the)f(program)149 708 y(#)91 b(depend:)25 b(Recompute)q(s)g(dependen)
q(ci)q(es)h(on)d(.h)g(files.)149 754 y(#)91 b(clean:)47
b(Remove)25 b(back-up)g(files)g(and)e(files)i(that)f(make)g(can)g
(reconstruc)q(t.)149 800 y(#)91 b(test:)69 b(Run)24 b(the)f(testing)j
(command)f(in)e(variable)j(TESTPROGR)q(AM)g(for)d(each)149
845 y(#)270 b(of)23 b(the)h(arguments)i(given)e(in)g(the)f(variable)j
(TESTS.)149 937 y(LOADLIBE)q(S)g(=)c(-lm)149 1028 y(LDFLAGS)k(=)d(-g)
149 1119 y(CXX)h(=)f(g++)149 1211 y(CXXFLAGS)j(=)d(-g)g(-Wall)149
1302 y(OBJS)i(=)d($\(CXX_SR)q(CS)q(:.c)q(c=)q(.o\))149
1393 y(#)h(Default)j(entry)149 1439 y(all:)f($\(PROGRAM\))149
1530 y($\(PROGRA)q(M\))h(:)d($\(OBJS\))329 1576 y($\(CXX\))i
($\(LDFLAGS\))h($\(OBJS\))g($\(LOADLIBE)q(S\))g(-o)d($\(PROGRA)q(M\))
149 1667 y(clean:)329 1713 y(/bin/rm)i(-f)e($\(OBJS\))j($\(PROGRAM\))g
(*\304)149 1804 y(test:)47 b($\(PROGRA)q(M\))329 1850
y(for)23 b(test)i(in)e($\(TESTS\);)j(do)d(\\)418 1895
y(echo)i("Running)g($\(TESTPR)q(OGR)q(AM)q(\))g($${test})h(...")e(;)f
(\\)418 1941 y(if)h($\(TESTPROG)q(RA)q(M\))i($${test};)g(then)e(\\)508
1987 y(echo)g("Test)h(succeeds.")q(;)h(\\)418 2032 y(else)f(echo)f
("Test)g(failed.";)i(\\)418 2078 y(fi;)e(\\)329 2124
y(done)149 2215 y(make.dep)q(en)q(d:)329 2261 y(rm)f(-f)g(make.dep)q
(end)329 2306 y($\(CXX\))i(-MM)e($\(CXX_SR)q(CS)q(\))i(>)e(make.depe)q
(nd)149 2398 y(depend:)329 2443 y($\(CXX\))i(-MM)e($\(CXX_SR)q(CS)q(\))
i(>)e(make.depe)q(nd)149 2535 y(#)g(If)h(the)f(make.dep)q(end)j(file)e
(does)g(not)g(exist,)h(gmake)f(will)g(use)g(the)g(rule)149
2580 y(#)f(for)h(make.depe)q(nd)i(above)e(to)g(create)h(it.)149
2626 y(include)h(make.depe)q(nd)75 2753 y Fm(Figure)10
b(1:)16 b(An)10 b(e)o(xample)h(of)f(a)h(standard)f(make\256le)g
(de\256nitions)g(that)f(can)i(be)g(included)f(from)g(a)g(speci\256c)h
(make\256le)75 2810 y(to)g(compile)f(man)o(y)h(simple)g(collections)f
(of)h(C++)h(programs.)p eop
%%Page: 48 10
48 9 bop 50 50 a Fm(48)1527 b Fc(P)-5 b(.)13 b(N.)e(Hil\256nger)50
199 y Fh(7)50 b(Make\256les)11 b(with)h(J)o(a)o(va)50
287 y Fm(T)l(o)e(be)h(honest,)g(Ja)o(v)o(a)f(does)g(not)g(sho)o(w)g
(the)h Fk(make)h Fm(utility)d(at)h(its)g(best.)16 b(The)11
b(problem)e(is)h(that)g(Ja)o(v)o(a)h(does)f(not)g(really)50
343 y(allo)o(w)j(the)h(separation)g(of)h(header)g(\256les)f(from)g
(implementation)e(\256les.)26 b(F)o(or)15 b(e)o(xample,)g(suppose)e
(\256le)i Fk(B.java)50 399 y Fm(contains)e(uses)h(of)g(methods)f(or)i
(classes)f(from)g Fk(A.java)p Fm(.)28 b(From)14 b Fk(make)p
Fm(')m(s)i(perspecti)o(v)o(e,)g(we)e(ha)o(v)o(e)h(to)f(say)g(that)50
456 y Fk(B.class)i Fm(depends)d(on)g Fk(A.java)p Fm(.)25
b(Thus,)13 b(whene)o(v)o(er)h(a)g(method)e(in)h Fk(A.java)i
Fm(is)e(changed,)i(as)e(far)g(as)h Fk(make)50 512 y Fm(kno)o(ws,)k
Fk(B.java)i Fm(must)c(be)h(recompiled\320e)o(v)o(en)g(if)g(the)g
(signatures)f(and)h(names)g(of)g(the)g(classes,)i(methods,)50
569 y(\256elds)13 b(in)g Fk(A.java)j Fm(ha)o(v)o(e)e(not)f(changed.)23
b(There)13 b(is)g(often)g(nothing)f(for)i(it)f(at)g(the)g(moment)f(b)o
(ut)h(to)g(write)g(tri)o(vial)50 625 y(sets)g(of)g(dependenc)o(y)h
(rules)g(in)f(which)g(e)o(v)o(ery)h Fk(.class)i Fm(\256le)e(depends)f
(on)g(e)o(v)o(ery)h Fk(.java)i Fm(\256le.)23 b(Still,)14
b Fk(make)h Fm(is)50 682 y(useful)10 b(for)h(making)f(the)g
(compilation)f(process)i(easy:)16 b(you)10 b(can)h(still)e(arrange)j
(for)e(a)h(plain)f Fk(gmake)j Fm(command)d(to)50 738
y(compile)g(e)o(v)o(erything)h(that)f(needs)h(to)g(be)g(compiled.)16
b(Thus,)11 b(a)g(Ja)o(v)o(a)g(program)g(contained)g(in)f(\256les)h
Fk(Main.jav)q(a)p Fm(,)50 795 y Fk(Car.java)p Fm(,)k
Fk(Truck.java)q Fm(,)g(and)c Fk(Drive.jav)q(a)j Fm(might)c(use)i
(make\256le)f(rules)g(like)f(this:)141 888 y Fk(PROGRAM)30
b(=)e(Main.clas)q(s)141 1001 y(JAVA_SRC)j(=)55 b(Main.java)31
b(Car.java)f(Truck.ja)q(va)h(Drive.java)141 1114 y(JFLAGS)f(=)e(-g)141
1227 y(#)g(This)h(defines)h(a)e(new)g(implicit)j(rule)e(for)g(getting)h
(.class)g(files)f(out)g(of)141 1284 y(#)f(.java)h(files.)h(This)f(rule)
g(says:)g(To)g(make)g(foo.class)i(from)e(foo.java,)141
1340 y(#)f(send)h(all)g(files)g(that)g(foo.class)i(depends)f(on)e
(\($\303\))h(to)f(javac.)141 1397 y(\045.class:)j(\045.java)360
1453 y(javac)f($\(JFLAGS\))h($\303)141 1566 y(CLASSES)f(=)e($\(JAVA_SR)
q(C:.)q(ja)q(va=)q(.c)q(las)q(s\))141 1679 y(all:)h($\(CLASSES)q(\))141
1792 y($\(CLASSES)q(\):)i($\(JAVA_SRC)q(\))p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
